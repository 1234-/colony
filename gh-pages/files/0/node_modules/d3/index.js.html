<h1>d3</h1>
<pre><code class="lang-js"><span class="keyword">var</span> self = <span class="keyword">this</span>,
    globals = [<span class="string">"document"</span>, <span class="string">"window"</span>, <span class="string">"navigator"</span>, <span class="string">"CSSStyleDeclaration"</span>, <span class="string">"d3"</span>, <span class="string">"Sizzle"</span>],
    globalValues = {};

globals.forEach(<span class="keyword">function</span>(global) {
  <span class="keyword">if</span> (global <span class="keyword">in</span> self) globalValues[global] = self[global];
});

document = require(<span class="string">"jsdom"</span>).jsdom(<span class="string">"&lt;html>&lt;head>&lt;/head>&lt;body>&lt;/body>&lt;/html>"</span>);
window = document.createWindow();
navigator = window.navigator;
CSSStyleDeclaration = window.CSSStyleDeclaration;

Sizzle = require(<span class="string">"sizzle"</span>);

require(<span class="string">"./d3.v2"</span>);

module.exports = d3;

globals.forEach(<span class="keyword">function</span>(global) {
  <span class="keyword">if</span> (global <span class="keyword">in</span> globalValues) self[global] = globalValues[global];
  <span class="keyword">else</span> <span class="keyword">delete</span> self[global];
});
</code></pre>