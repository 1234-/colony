<h1>CSSStyleSheet.js</h1>
<pre><code class="lang-js"><span class="comment">//.CommonJS</span>
<span class="keyword">var</span> CSSOM = {
	StyleSheet: require(<span class="string">"./StyleSheet"</span>).StyleSheet,
	CSSStyleRule: require(<span class="string">"./CSSStyleRule"</span>).CSSStyleRule
};
<span class="comment">///CommonJS</span>


<span class="comment">/**
 * @constructor
 * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet
 */</span>
CSSOM.CSSStyleSheet = <span class="function"><span class="keyword">function</span> <span class="title">CSSStyleSheet</span><span class="params">()</span> {</span>
	CSSOM.StyleSheet.call(<span class="keyword">this</span>);
	<span class="keyword">this</span>.cssRules = [];
};


CSSOM.CSSStyleSheet.prototype = <span class="keyword">new</span> CSSOM.StyleSheet;
CSSOM.CSSStyleSheet.prototype.constructor = CSSOM.CSSStyleSheet;


<span class="comment">/**
 * Used to insert a new rule into the style sheet. The new rule now becomes part of the cascade.
 *
 *   sheet = new Sheet("body {margin: 0}")
 *   sheet.toString()
 *   -> "body{margin:0;}"
 *   sheet.insertRule("img {border: none}", 0)
 *   -> 0
 *   sheet.toString()
 *   -> "img{border:none;}body{margin:0;}"
 *
 * @param {string} rule
 * @param {number} index
 * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-insertRule
 * @return {number} The index within the style sheet's rule collection of the newly inserted rule.
 */</span>
CSSOM.CSSStyleSheet.prototype.insertRule = <span class="keyword">function</span>(rule, index) {
	<span class="keyword">if</span> (index &lt; <span class="number">0</span> || index > <span class="keyword">this</span>.cssRules.length) {
		<span class="keyword">throw</span> <span class="keyword">new</span> RangeError(<span class="string">"INDEX_SIZE_ERR"</span>);
	}
	<span class="keyword">var</span> cssRule = CSSOM.parse(rule).cssRules[<span class="number">0</span>];
	<span class="keyword">this</span>.cssRules.splice(index, <span class="number">0</span>, cssRule);
	<span class="keyword">return</span> index;
};


<span class="comment">/**
 * Used to delete a rule from the style sheet.
 *
 *   sheet = new Sheet("img{border:none} body{margin:0}")
 *   sheet.toString()
 *   -> "img{border:none;}body{margin:0;}"
 *   sheet.deleteRule(0)
 *   sheet.toString()
 *   -> "body{margin:0;}"
 *
 * @param {number} index within the style sheet's rule list of the rule to remove.
 * @see http://www.w3.org/TR/DOM-Level-2-Style/css.html#CSS-CSSStyleSheet-deleteRule
 */</span>
CSSOM.CSSStyleSheet.prototype.deleteRule = <span class="keyword">function</span>(index) {
	<span class="keyword">if</span> (index &lt; <span class="number">0</span> || index >= <span class="keyword">this</span>.cssRules.length) {
		<span class="keyword">throw</span> <span class="keyword">new</span> RangeError(<span class="string">"INDEX_SIZE_ERR"</span>);
	}
	<span class="keyword">this</span>.cssRules.splice(index, <span class="number">1</span>);
};


<span class="comment">/**
 * NON-STANDARD
 * @return {string} serialize stylesheet
 */</span>
CSSOM.CSSStyleSheet.prototype.toString = <span class="keyword">function</span>() {
	<span class="keyword">var</span> result = <span class="string">""</span>;
	<span class="keyword">var</span> rules = <span class="keyword">this</span>.cssRules;
	<span class="keyword">for</span> (<span class="keyword">var</span> i=<span class="number">0</span>; i&lt;rules.length; i++) {
		result += rules[i].cssText + <span class="string">"\n"</span>;
	}
	<span class="keyword">return</span> result;
};


<span class="comment">//.CommonJS</span>
exports.CSSStyleSheet = CSSOM.CSSStyleSheet;
CSSOM.parse = require(<span class="string">'./parse'</span>).parse; <span class="comment">// Cannot be included sooner due to the mutual dependency between parse.js and CSSStyleSheet.js</span>
<span class="comment">///CommonJS</span>
</code></pre>