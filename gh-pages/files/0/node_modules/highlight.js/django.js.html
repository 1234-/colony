<h1>django.js</h1>
<pre><code class="lang-js">module.exports = <span class="keyword">function</span>(hljs) {

  <span class="function"><span class="keyword">function</span> <span class="title">allowsDjangoSyntax</span><span class="params">(mode, parent)</span> {</span>
    <span class="keyword">return</span> (
      parent == <span class="literal">undefined</span> || <span class="comment">// default mode</span>
      (!mode.className &amp;&amp; parent.className == <span class="string">'tag'</span>) || <span class="comment">// tag_internal</span>
      mode.className == <span class="string">'value'</span> <span class="comment">// value</span>
    );
  }

  <span class="function"><span class="keyword">function</span> <span class="title">copy</span><span class="params">(mode, parent)</span> {</span>
    <span class="keyword">var</span> result = {};
    <span class="keyword">for</span> (<span class="keyword">var</span> key <span class="keyword">in</span> mode) {
      <span class="keyword">if</span> (key != <span class="string">'contains'</span>) {
        result[key] = mode[key];
      }
      <span class="keyword">var</span> contains = [];
      <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>; mode.contains &amp;&amp; i &lt; mode.contains.length; i++) {
        contains.push(copy(mode.contains[i], mode));
      }
      <span class="keyword">if</span> (allowsDjangoSyntax(mode, parent)) {
        contains = DJANGO_CONTAINS.concat(contains);
      }
      <span class="keyword">if</span> (contains.length) {
        result.contains = contains;
      }
    }
    <span class="keyword">return</span> result;
  }

  <span class="keyword">var</span> FILTER = {
    className: <span class="string">'filter'</span>,
    begin: <span class="string">'\\|[A-Za-z]+\\:?'</span>, excludeEnd: <span class="literal">true</span>,
    keywords:
      <span class="string">'truncatewords removetags linebreaksbr yesno get_digit timesince random striptags '</span> +
      <span class="string">'filesizeformat escape linebreaks length_is ljust rjust cut urlize fix_ampersands '</span> +
      <span class="string">'title floatformat capfirst pprint divisibleby add make_list unordered_list urlencode '</span> +
      <span class="string">'timeuntil urlizetrunc wordcount stringformat linenumbers slice date dictsort '</span> +
      <span class="string">'dictsortreversed default_if_none pluralize lower join center default '</span> +
      <span class="string">'truncatewords_html upper length phone2numeric wordwrap time addslashes slugify first '</span> +
      <span class="string">'escapejs force_escape iriencode last safe safeseq truncatechars localize unlocalize '</span> +
      <span class="string">'localtime utc timezone'</span>,
    contains: [
      {className: <span class="string">'argument'</span>, begin: <span class="string">'"'</span>, end: <span class="string">'"'</span>}
    ]
  };

  <span class="keyword">var</span> DJANGO_CONTAINS = [
    {
      className: <span class="string">'template_comment'</span>,
      begin: <span class="string">'{%\\s*comment\\s*%}'</span>, end: <span class="string">'{%\\s*endcomment\\s*%}'</span>
    },
    {
      className: <span class="string">'template_comment'</span>,
      begin: <span class="string">'{#'</span>, end: <span class="string">'#}'</span>
    },
    {
      className: <span class="string">'template_tag'</span>,
      begin: <span class="string">'{%'</span>, end: <span class="string">'%}'</span>,
      keywords:
        <span class="string">'comment endcomment load templatetag ifchanged endifchanged if endif firstof for '</span> +
        <span class="string">'endfor in ifnotequal endifnotequal widthratio extends include spaceless '</span> +
        <span class="string">'endspaceless regroup by as ifequal endifequal ssi now with cycle url filter '</span> +
        <span class="string">'endfilter debug block endblock else autoescape endautoescape csrf_token empty elif '</span> +
        <span class="string">'endwith static trans blocktrans endblocktrans get_static_prefix get_media_prefix '</span> +
        <span class="string">'plural get_current_language language get_available_languages '</span> +
        <span class="string">'get_current_language_bidi get_language_info get_language_info_list localize '</span> +
        <span class="string">'endlocalize localtime endlocaltime timezone endtimezone get_current_timezone'</span>,
      contains: [FILTER]
    },
    {
      className: <span class="string">'variable'</span>,
      begin: <span class="string">'{{'</span>, end: <span class="string">'}}'</span>,
      contains: [FILTER]
    }
  ];

  <span class="keyword">var</span> result = copy(hljs.LANGUAGES.xml);
  result.case_insensitive = <span class="literal">true</span>;
  <span class="keyword">return</span> result;
};</code></pre>