<h1>lua.js</h1>
<pre><code class="lang-js">module.exports = <span class="keyword">function</span>(hljs) {
  <span class="keyword">var</span> OPENING_LONG_BRACKET = <span class="string">'\\[=*\\['</span>;
  <span class="keyword">var</span> CLOSING_LONG_BRACKET = <span class="string">'\\]=*\\]'</span>;
  <span class="keyword">var</span> LONG_BRACKETS = {
    begin: OPENING_LONG_BRACKET, end: CLOSING_LONG_BRACKET,
    contains: [<span class="string">'self'</span>]
  };
  <span class="keyword">var</span> COMMENTS = [
    {
      className: <span class="string">'comment'</span>,
      begin: <span class="string">'--(?!'</span> + OPENING_LONG_BRACKET + <span class="string">')'</span>, end: <span class="string">'$'</span>
    },
    {
      className: <span class="string">'comment'</span>,
      begin: <span class="string">'--'</span> + OPENING_LONG_BRACKET, end: CLOSING_LONG_BRACKET,
      contains: [LONG_BRACKETS],
      relevance: <span class="number">10</span>
    }
  ]
  <span class="keyword">return</span> {
    lexems: hljs.UNDERSCORE_IDENT_RE,
    keywords: {
      keyword:
        <span class="string">'and break do else elseif end false for if in local nil not or repeat return then '</span> +
        <span class="string">'true until while'</span>,
      built_in:
        <span class="string">'_G _VERSION assert collectgarbage dofile error getfenv getmetatable ipairs load '</span> +
        <span class="string">'loadfile loadstring module next pairs pcall print rawequal rawget rawset require '</span> +
        <span class="string">'select setfenv setmetatable tonumber tostring type unpack xpcall coroutine debug '</span> +
        <span class="string">'io math os package string table'</span>
    },
    contains: COMMENTS.concat([
      {
        className: <span class="string">'function'</span>,
        beginWithKeyword: <span class="literal">true</span>, end: <span class="string">'\\)'</span>,
        keywords: <span class="string">'function'</span>,
        contains: [
          {
            className: <span class="string">'title'</span>,
            begin: <span class="string">'([_a-zA-Z]\\w*\\.)*([_a-zA-Z]\\w*:)?[_a-zA-Z]\\w*'</span>
          },
          {
            className: <span class="string">'params'</span>,
            begin: <span class="string">'\\('</span>, endsWithParent: <span class="literal">true</span>,
            contains: COMMENTS
          }
        ].concat(COMMENTS)
      },
      hljs.C_NUMBER_MODE,
      hljs.APOS_STRING_MODE,
      hljs.QUOTE_STRING_MODE,
      {
        className: <span class="string">'string'</span>,
        begin: OPENING_LONG_BRACKET, end: CLOSING_LONG_BRACKET,
        contains: [LONG_BRACKETS],
        relevance: <span class="number">10</span>
      }
    ])
  };
};</code></pre>